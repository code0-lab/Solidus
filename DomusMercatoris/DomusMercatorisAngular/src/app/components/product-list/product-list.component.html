<div #container class="list-container">
  <cdk-virtual-scroll-viewport [itemSize]="itemHeight" minBufferPx="900" maxBufferPx="2000" (scrolledIndexChange)="onScrollIndexChanged()" class="viewport">
    <div *cdkVirtualFor="let row of rows" class="product-row" [style.grid-template-columns]="'repeat(' + cols + ', 1fr)'">
      @for (product of row; track product.id) {
        <div class="product-card" (click)="selectProduct.emit(product)">
          <div class="card-image" [style.background-color]="product.bg">
            <img [src]="product.imageUrl" [alt]="product.name" loading="lazy">
          </div>
          <div class="card-content">
            <span class="sku">{{ product.sku }}</span>
            <h3>{{ product.name }}</h3>
            <div class="price">{{ product.priceText }}</div>
          </div>
          <button class="add-cart-btn" (click)="addToCart($event, product)">Add to Cart</button>
        </div>
      }
    </div>
  </cdk-virtual-scroll-viewport>
</div>
